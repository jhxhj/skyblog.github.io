<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>skyj</title>
  
  <subtitle>Ops Developer &amp; Framework Designer</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.99408.com/"/>
  <updated>2020-06-03T02:13:35.098Z</updated>
  <id>http://blog.99408.com/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>本博使用主题pure修改</title>
    <link href="http://blog.99408.com/2020/06/03/%E6%9C%AC%E5%8D%9A%E4%BD%BF%E7%94%A8%E4%B8%BB%E9%A2%98pure%E4%BF%AE%E6%94%B9/"/>
    <id>http://blog.99408.com/2020/06/03/%E6%9C%AC%E5%8D%9A%E4%BD%BF%E7%94%A8%E4%B8%BB%E9%A2%98pure%E4%BF%AE%E6%94%B9/</id>
    <published>2020-06-03T01:55:00.000Z</published>
    <updated>2020-06-03T02:13:35.098Z</updated>
    
    <content type="html"><![CDATA[<p>配置文件说明<br />在 Hexo 中有两份主要的配置文件，其名称都是 _config.yml。 其中，一份位于站点根目录下，主要包含 Hexo 本身的配置；另一份位于主题目录下，这份配置由主题作者提供，主要用于配置主题相关的选项。</p><p>为了描述方便，在以下说明中，将前者称为站点配置文件， 后者称为主题配置文件。</p><p>启用pure主题<br />安装主题</p><p>git clone <a href="https://github.com/cofess/hexo-theme-pure.git" target="_blank" rel="noopener">https://github.com/cofess/hexo-theme-pure.git</a> themes/pure</p><p>打开站点配置文件，找到theme字段，将其值更改为 pure。</p><p>theme: next</p><p>更新主题</p><p>cd themes/pure<br />git pull</p><p>到此，主题安装完成。然后启动Hexo服务验证主题是否正确启用。</p><p>hexo s</p><p>使用浏览器访问 <a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a> ，检查主题是否被启用。</p><p>主题设定<br />设置语言<br />打开站点配置文件, 将 language 设置成你所需要的语言。建议明确设置你所需要的语言,可选值对应themes\pure\languages目录下语言文件，简体中文配置如下：</p><p>language: zh-CN</p><p>设置个人信息<br />头像在themes\pure\source\images 目录下替换图片即可，捐献的二维码同理。</p><p>个人信息大部分都在 主题配置文件 中设置</p><p>设置菜单<br />右边导航菜单在主题配置文件中配置</p><h1 id="导航菜单"><a class="markdownIt-Anchor" href="#导航菜单"></a> 导航菜单</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">menu:  </span><br><span class="line">  Home: .   </span><br><span class="line">  Archives: archives # 归档  </span><br><span class="line">  Categories: categories # 分类  </span><br><span class="line">  Tags: tags # 标签  </span><br><span class="line">  Repository: repository # github repositories  </span><br><span class="line">  Books: books     # 书单  </span><br><span class="line">  Links: links # 友链  </span><br><span class="line">  About: about # 关于</span><br></pre></td></tr></table></figure><h1 id="导航菜单图标font-awesome"><a class="markdownIt-Anchor" href="#导航菜单图标font-awesome"></a> 导航菜单图标（font awesome）</h1><pre><code>menu_icons:    enable: true # 是否启用菜单图标    home: fa-dashboard    archives: fa-delicious    categories: fa-folder    tags: fa-tags    repository: fa-code    books: fa-leanpub    links: fa-gg    about: fa-coffee  </code></pre><p>添加背景动画<br />背景动画基于canvas，在\themes\pure\layout\layout.ejs的中面添加</p><pre><code>&lt;script type=&quot;text/javascript&quot; src=&quot;//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js&quot;&gt;  &lt;/script&gt;  </code></pre><p>站点建立时间<br />这个时间将在站点的底部显示，例如 © 2017。 编辑 主题配置文件，新增字段 since。</p><p>配置示例：</p><p>since: 2017</p><p>添加404公益页面<br />GitHub Pages有提供制作404页面的指引：Custom 404 Pages。</p><p>但是自定义404页面仅对绑定顶级域名的项目才起作用，GitHub默认分配的二级域名是不起作用的，使用hexo server在本机调试也是不起作用的。</p><p>使用方法：新建 404.html 页面，放到主题的 source 目录下，内容如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE HTML&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta http-equiv&#x3D;&quot;content-type&quot; content&#x3D;&quot;text&#x2F;html;charset&#x3D;utf-8;&quot;&#x2F;&gt;</span><br><span class="line">  &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge,chrome&#x3D;1&quot; &#x2F;&gt;</span><br><span class="line">  &lt;meta name&#x3D;&quot;robots&quot; content&#x3D;&quot;all&quot; &#x2F;&gt;</span><br><span class="line">  &lt;meta name&#x3D;&quot;robots&quot; content&#x3D;&quot;index,follow&quot;&#x2F;&gt;</span><br><span class="line">  &lt;link rel&#x3D;&quot;stylesheet&quot; type&#x3D;&quot;text&#x2F;css&quot; href&#x3D;&quot;https:&#x2F;&#x2F;qzone.qq.com&#x2F;gy&#x2F;404&#x2F;style&#x2F;404style.css&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;script type&#x3D;&quot;text&#x2F;plain&quot; src&#x3D;&quot;http:&#x2F;&#x2F;www.qq.com&#x2F;404&#x2F;search_children.js&quot;</span><br><span class="line">          charset&#x3D;&quot;utf-8&quot; homePageUrl&#x3D;&quot;&#x2F;&quot;</span><br><span class="line">          homePageName&#x3D;&quot;回到我的主页&quot;&gt;</span><br><span class="line">  &lt;&#x2F;script&gt;</span><br><span class="line">  &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;qzone.qq.com&#x2F;gy&#x2F;404&#x2F;data.js&quot; charset&#x3D;&quot;utf-8&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">  &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;qzone.qq.com&#x2F;gy&#x2F;404&#x2F;page.js&quot; charset&#x3D;&quot;utf-8&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line">&#96;&#96;&#96; </span><br><span class="line">阅读次数统计  </span><br><span class="line">本来想用leancloud来统计，因为不蒜子不能管理相关博文的阅读量，但是配置完leancloud会报错~..~只能选用不蒜子，在主题配置文件 中把busuanzi设置为true即可：</span><br></pre></td></tr></table></figure><p>pv:<br />busuanzi:<br />enable: true  # 不蒜子统计</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">常用插件及用法</span><br><span class="line">hexo-admin</span><br><span class="line">Github：https:&#x2F;&#x2F;github.com&#x2F;jaredly&#x2F;hexo-admin</span><br><span class="line"></span><br><span class="line">简介：可以直接在网页端创建、编辑markdown文章内容，并将内容发布到_posts里。最方便的是可以很方便的给文章加标题、分类、打标签。</span><br><span class="line"></span><br><span class="line">安装和使用：</span><br><span class="line"></span><br><span class="line">安装这个插件需要升级npm，先升级</span><br><span class="line"></span><br><span class="line">npm install -g npm</span><br><span class="line"></span><br><span class="line">然后安装</span><br><span class="line"></span><br><span class="line">npm install --save hexo-admin</span><br><span class="line"></span><br><span class="line">配置：</span><br><span class="line"></span><br><span class="line">在站点配置文件 _config.yml中添加</span><br></pre></td></tr></table></figure><p>admin:<br />username: myfavoritename<br />password_hash: be121740bf988b2225a313fa1f107ca1<br />secret: a secret something</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">这个配置可以直接在admin Settings &gt; Setup authentification 页面中输入数据获取，secret是用于产生cookie值的。</span><br><span class="line"></span><br><span class="line">hexo-douban  </span><br><span class="line">Github：https:&#x2F;&#x2F;github.com&#x2F;mythsman&#x2F;hexo-douban</span><br><span class="line"></span><br><span class="line">简介：为博客添加豆瓣书单和豆瓣电影。（不支持分页，数据大网络差有可能出现超时错误）</span><br><span class="line"></span><br><span class="line">安装：</span><br><span class="line"></span><br><span class="line">npm install hexo-douban --save</span><br><span class="line"></span><br><span class="line">配置：</span><br><span class="line"></span><br><span class="line">在站点配置文件 _config.yml中添加</span><br></pre></td></tr></table></figure><p>douban:<br />user: 豆瓣个性域名<br />book:<br />title: ‘This is my book title’<br />quote: ‘This is my book quote’<br />movie:<br />title: ‘This is my movie title’<br />quote: ‘This is my movie quote’</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在主题配置文件 中修改menu</span><br></pre></td></tr></table></figure><p>menu:<br />Home: /<br />Archives: /archives<br />Books: /books     #This is your books page<br />Movies: /movies   #This is your movies page</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">hexo-wordcount  </span><br><span class="line">Github：https:&#x2F;&#x2F;github.com&#x2F;willin&#x2F;hexo-wordcount</span><br><span class="line"></span><br><span class="line">简介：为文章添加文章字数统计、文章预计阅读时间</span><br><span class="line"></span><br><span class="line">安装：</span><br><span class="line"></span><br><span class="line">npm install hexo-wordcount --save</span><br><span class="line"></span><br><span class="line">配置：</span><br><span class="line"></span><br><span class="line">在主题配置文件 中设置为true：</span><br><span class="line"></span><br><span class="line"># wordcount</span><br></pre></td></tr></table></figure><p>postCount:<br />enable: true<br />wordcount: true  # 文章字数统计<br />min2read: true  # 阅读时长预计</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">hexo-autonofollow  </span><br><span class="line">Github：https:&#x2F;&#x2F;github.com&#x2F;liuzc&#x2F;hexo-autonofollow</span><br><span class="line"></span><br><span class="line">简介：自动为站外链接添加nofollow属性</span><br><span class="line"></span><br><span class="line">安装：</span><br><span class="line"></span><br><span class="line">npm install hexo-autonofollow --save</span><br><span class="line"></span><br><span class="line">配置：</span><br><span class="line"></span><br><span class="line">在站点配置文件_config.yml中添加</span><br></pre></td></tr></table></figure><p>nofollow:<br />enable: true<br />exclude:<br />- <a href="http://exclude1.com" target="_blank" rel="noopener">exclude1.com</a><br />- <a href="http://exclude2.com" target="_blank" rel="noopener">exclude2.com</a></p><p>enable - 是否启用<br />exclude - 排除域名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">hexo-generator-feed  </span><br><span class="line">Github：https:&#x2F;&#x2F;github.com&#x2F;hexojs&#x2F;hexo-generator-feed</span><br><span class="line"></span><br><span class="line">简介：RSS的生成插件，你可以在配置显示你站点的RSS，文件路径\atom.xml。</span><br><span class="line"></span><br><span class="line">安装：</span><br><span class="line"></span><br><span class="line">npm install hexo-generator-feed --save</span><br><span class="line"></span><br><span class="line">配置：</span><br><span class="line"></span><br><span class="line">在站点配置文件_config.yml中添加</span><br></pre></td></tr></table></figure><p>feed:<br />type: atom<br />path: atom.xml<br />limit: 20<br />hub:<br />content:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">type - Feed type. (atom&#x2F;rss2)   </span><br><span class="line">path - Feed path. (Default: atom.xml&#x2F;rss2.xml)  </span><br><span class="line">limit - Maximum number of posts in the feed (Use 0 or false to show all posts)  </span><br><span class="line">hub - URL of the PubSubHubbub hubs (Leave it empty if you don’t use it)  </span><br><span class="line">content - (optional) set to ‘true’ to include the contents of the entire post in the feed.  </span><br><span class="line"></span><br><span class="line">hexo-generator-sitemap  </span><br><span class="line">Github：https:&#x2F;&#x2F;github.com&#x2F;hexojs&#x2F;hexo-generator-sitemap</span><br><span class="line"></span><br><span class="line">简介：生成博客的sitemap。</span><br><span class="line"></span><br><span class="line">安装：</span><br><span class="line"></span><br><span class="line">npm install hexo-generator-sitemap --save</span><br><span class="line"></span><br><span class="line">配置：</span><br><span class="line"></span><br><span class="line">在站点配置文件_config.yml中添加</span><br></pre></td></tr></table></figure><p>sitemap:<br />path: sitemap.xml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">hexo-generator-baidu-sitemap  </span><br><span class="line">Github：https:&#x2F;&#x2F;github.com&#x2F;coneycode&#x2F;hexo-generator-baidu-sitemap</span><br><span class="line"></span><br><span class="line">简介：生成博客的sitemap（针对百度）。</span><br><span class="line"></span><br><span class="line">安装：</span><br><span class="line"></span><br><span class="line">install hexo-generator-baidu-sitemap --save</span><br><span class="line"></span><br><span class="line">配置：</span><br><span class="line"></span><br><span class="line">在站点配置文件_config.yml中添加</span><br></pre></td></tr></table></figure><p>baidusitemap:<br />path: baidusitemap.xml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">hexo-generator-json-content  </span><br><span class="line">Github：https:&#x2F;&#x2F;github.com&#x2F;alexbruno&#x2F;hexo-generator-json-content</span><br><span class="line"></span><br><span class="line">简介：用于生成静态站点数据，提供搜索功能的数据源。</span><br><span class="line"></span><br><span class="line">安装：</span><br><span class="line"></span><br><span class="line">npm install hexo-generator-json-content --save</span><br><span class="line"></span><br><span class="line">配置：</span><br><span class="line"></span><br><span class="line">在站点配置文件_config.yml中添加</span><br></pre></td></tr></table></figure><p>jsonContent:<br />ignore:<br />- path/to/a/page<br />- url/to/one/post<br />- an-entire-category<br />- specific.file<br />- .ext # a file extension</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">hexo-neat  </span><br><span class="line">Github：https:&#x2F;&#x2F;github.com&#x2F;rozbo&#x2F;hexo-neat</span><br><span class="line"></span><br><span class="line">简介：自动压缩html、css、js代码</span><br><span class="line"></span><br><span class="line">安装：</span><br><span class="line"></span><br><span class="line">npm install hexo-neat --save  </span><br><span class="line"></span><br><span class="line">配置：</span><br><span class="line"></span><br><span class="line">在站点配置文件_config.yml中添加</span><br></pre></td></tr></table></figure><p>neat_enable: true<br />neat_html:<br />enable: ture<br />exclude:<br />neat_css:<br />enable: true<br />exclude:<br />- ‘<em>.min.css’<br />neat_js:<br />enable: true<br />mangle: true<br />output:<br />compress:<br />exclude:<br />- '</em>.min.js’</p><pre class="highlight"><code class="">参考  http://theme-next.iissnan.com/getting-started.htmlhttps://github.com/cofess/hexo-theme-pure/blob/master/README.cn.mdhttp://blog.cofess.com/2017/08/16/comon-plugins-and-usage-of-hexo-blog.html</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;配置文件说明&lt;br /&gt;
在 Hexo 中有两份主要的配置文件，其名称都是 _config.yml。 其中，一份位于站点根目录下，主要包含 Hexo 本身的配置；另一份位于主题目录下，这份配置由主题作者提供，主要用于配置主题相关的选项。&lt;/p&gt;
&lt;p&gt;为了描述方便，在以下说
      
    
    </summary>
    
    
      <category term="blog" scheme="http://blog.99408.com/categories/blog/"/>
    
    
      <category term="blog" scheme="http://blog.99408.com/tags/blog/"/>
    
  </entry>
  
  <entry>
    <title>ELK安装</title>
    <link href="http://blog.99408.com/2020/05/26/test/"/>
    <id>http://blog.99408.com/2020/05/26/test/</id>
    <published>2020-05-26T10:38:00.000Z</published>
    <updated>2020-06-03T02:17:24.135Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/pasted-3.png" alt="upload successful" /></p><p><img src="/images/pasted-8.png" alt="upload successful" /><br />1.安装环境</p><p>1.1安装elasticsearch,kibana,logstash<br />yum install java -y<br />wget <a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.2.4.rpm" target="_blank" rel="noopener">https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.2.4.rpm</a><br />wget <a href="https://artifacts.elastic.co/downloads/logstash/logstash-6.2.4.rpm" target="_blank" rel="noopener">https://artifacts.elastic.co/downloads/logstash/logstash-6.2.4.rpm</a><br />rpm -ivh logstash-6.2.4.rpm<br />rpm -ivh kibana-6.2.4-x86_64.rpm<br />rpm -ivh logstash-6.2.4.rpm</p><p>编辑配置文件  因为是集群，所有三台都需要安装ES，配置里名字不相同，xpack开始可以先不启用。<br />vi /etc/elasticsearch/elasticsearch.yml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">cluster.name: jj-cluster  </span><br><span class="line">node.name: jjmaster-node  </span><br><span class="line">#node.name: 192.168.147.82  </span><br><span class="line">node.master: true  </span><br><span class="line">node.data: false  </span><br><span class="line">network.host: jjmaster-node  </span><br><span class="line">#network.host: 192.168.147.82  </span><br><span class="line">http.port: 9200  </span><br><span class="line">discovery.zen.ping.unicast.hosts: [&quot;192.168.147.82&quot;, &quot;192.168.147.125&quot;, &quot;192.168.147.110&quot;]  </span><br><span class="line">path.repo: [&quot;&#x2F;jjdata&#x2F;bak&quot;]  </span><br><span class="line">bootstrap.system_call_filter: false  </span><br><span class="line">xpack.security.enabled: true  </span><br><span class="line">xpack.security.transport.ssl.enabled: true  </span><br><span class="line">xpack.security.transport.ssl.verification_mode: certificate  </span><br><span class="line">xpack.security.transport.ssl.keystore.path: certs&#x2F;elastic-certificates.p12  </span><br><span class="line">xpack.security.transport.ssl.truststore.path: certs&#x2F;elastic-certificates.p12  </span><br><span class="line">xpack.notification.email.account:  </span><br><span class="line">    exchange_account:  </span><br><span class="line">        profile: outlook  </span><br><span class="line">        email_defaults:  </span><br><span class="line">            from: jh@163.com  </span><br><span class="line">        smtp:  </span><br><span class="line">            auth: true  </span><br><span class="line">            starttls.enable: false  </span><br><span class="line">            host: smtp.163.com  </span><br><span class="line">            port: 25  </span><br><span class="line">            user: jh@163.com  </span><br><span class="line">            password: Jj</span><br></pre></td></tr></table></figure><p>证书存放位置<br />/etc/elasticsearch/certs/elastic-certificates.p12<br />/usr/share/elasticsearch/certs/elastic-certificates.p12</p><p>vi  /etc/security/limits.conf（配置了memory_lock需要增加二个无限）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">elk       soft    nofile          819200  </span><br><span class="line">elk       hard    nofile          819200</span><br><span class="line">elk       soft    memlock        unlimited</span><br><span class="line">elk       hard    memlock        unlimited</span><br></pre></td></tr></table></figure><p>echo ‘ulimit -SHn 65536’ &gt;&gt; /etc/profile（如有此项的要删除或是改大）</p><p>vi /etc/sysctl.conf<br />vm.max_map_count=262144<br />sysctl -p</p><p>vi /etc/security/limits.d/90-nproc.conf</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">*          soft    nproc     1024  </span><br><span class="line">修改为：  </span><br><span class="line">*          soft    nproc     2048</span><br></pre></td></tr></table></figure><p>修改JVM.OPTIONS默认内容容量（默认2G）</p><p>-Xms256m<br />-Xmx256m</p><p>创建运行帐号（此步为TAR包安装，es不能使用root帐号启动，如果是rpm安装可以忽略<br />[root@elk bin]# useradd elk<br />[root@elk bin]# passwd elk</p><p>[root@elk app]# chown elk:elk elasticsearch-5.5.2 -R<br />[root@elk app]# mkdir /jjdata/bak （备份目录二种安装方式都需要）<br />[root@elk app]# chown elk:elk /jjhdata/bak -R</p><p>su - elk -c /jjhdata/app/elasticsearch-5.5.2/bin/elasticsearch<br />执行进行测试</p><p>安装x-pack<br />./elasticsearch-plugin install x-pack<br />修改默认账户信息<br />• Elasticsearch 的默认账户为 elastic 默认密码为 changme</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT -u elastic &#39;http:&#x2F;&#x2F;localhost:9200&#x2F;_xpack&#x2F;security&#x2F;user&#x2F;elastic&#x2F;_password&#39; -d &#39;&#123;</span><br><span class="line">  &quot;password&quot; : &quot;yourpasswd&quot;</span><br><span class="line">&#125;&#39;s  </span><br><span class="line">curl -XPUT -u elastic &#39;http:&#x2F;&#x2F;localhost:9200&#x2F;_xpack&#x2F;security&#x2F;user&#x2F;kibana&#x2F;_password&#39; -d &#39;&#123;</span><br><span class="line">  &quot;password&quot; : &quot;yourpasswd&quot;</span><br></pre></td></tr></table></figure><p>执行测试x-pack是否正常<br />curl -XGET -u elastic:changeme <a href="http://192.168.147.82:9200/" target="_blank" rel="noopener">http://192.168.147.82:9200/</a></p><p>其中x-pack是商用版本可以申请试用，或是免费基本1年的，又或是得参考网上CC</p><p>将编辑好的license.json文件放到服务器，在文件目录下执行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost Downloads]#curl -XPUT -u elastic:changeme   &#39;http:&#x2F;&#x2F;192.168.147.82:9200&#x2F;_xpack&#x2F;license&#39; -d @license.json  </span><br><span class="line">或者下面：  </span><br><span class="line">[root@localhost Downloads]#curl -XPUT -u elastic:changeme &#39;http:&#x2F;&#x2F;192.168.147.82:9200&#x2F;_xpack&#x2F;license?acknowledge&#x3D;true&#39; -d @license.json</span><br><span class="line"></span><br><span class="line">curl -XPUT -u elastic:changeme &#39;http:&#x2F;&#x2F;192.168.147.82:9200&#x2F;_xpack&#x2F;license?acknowledge&#x3D;true&#39; -d @xing-489611f8-974f-4650-b828-51d9cddcce29-v5.json</span><br></pre></td></tr></table></figure><p>重启elasticsearch和kibana .<br />查看当前的license</p><p>[root@localhost Downloads]# curl -XGET -u elastic:changeme ‘<a href="http://192.168.147.82:9200/_license" target="_blank" rel="noopener">http://192.168.147.82:9200/_license</a>’</p><p>1.2<br />设置kibana</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">elasticsearch.url: &quot;http:&#x2F;&#x2F;192.168.176.82:9200&quot;</span><br><span class="line">elasticsearch.username: &quot;kibana&quot;  </span><br><span class="line">elasticsearch.password: &quot;jjdd&quot;  </span><br><span class="line">tilemap.url: &#39;http:&#x2F;&#x2F;webrd02.is.autonavi.com&#x2F;appmaptile?lang&#x3D;zh_cn&amp;size&#x3D;1&amp;scale&#x3D;1&amp;style&#x3D;7&amp;x&#x3D;&#123;x&#125;&amp;y&#x3D;&#123;y&#125;&amp;z&#x3D;&#123;z&#125;&#39; #地图使用</span><br></pre></td></tr></table></figure><p>破解X-PACK<br />cd /usr/share/kibana/plugins/x-pack/<br />修改<br />_xpack_info.js<br />删除/usr/share/kibana/optimize/<br />启动<br />service kibana start<br />登录帐号密码<br />elastic:changeme<br />登录后可以修改密码，修改kibana密码后需要在kibana 配置文件里修改<br />安装nginx<br />nginx.conf</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  auto;  </span><br><span class="line">events &#123;  </span><br><span class="line">    worker_connections  1024;  </span><br><span class="line">&#125;  </span><br><span class="line">http &#123;  </span><br><span class="line">    include       mime.types;  </span><br><span class="line">    default_type  application&#x2F;octet-stream;  </span><br><span class="line">    sendfile        on;  </span><br><span class="line">    keepalive_timeout  65;  </span><br><span class="line">server &#123;  </span><br><span class="line">    listen 8080;  </span><br><span class="line">    server_name elk.test.com;  </span><br><span class="line">    location &#x2F; &#123;  </span><br><span class="line">        proxy_pass http:&#x2F;&#x2F;elk.test.com:5601;  </span><br><span class="line">        proxy_http_version 1.1;  </span><br><span class="line">        proxy_set_header Upgrade $http_upgrade;  </span><br><span class="line">        proxy_set_header Connection &#39;upgrade&#39;;  </span><br><span class="line">        proxy_set_header Host $host;  </span><br><span class="line">        proxy_cache_bypass $http_upgrade;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">server &#123;  </span><br><span class="line">        listen       443 ssl;  </span><br><span class="line">        server_name elk.test.com;  </span><br><span class="line">        ssl on;  </span><br><span class="line">        ssl_certificate &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;test.crt;  </span><br><span class="line">        ssl_certificate_key &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;test.key;  </span><br><span class="line">        ssl_ciphers ECDH:AESGCM:HIGH:!RC4:!DH:!MD5:!aNULL:!eNULL;  </span><br><span class="line">        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;  </span><br><span class="line">        ssl_prefer_server_ciphers on;  </span><br><span class="line">        ssl_session_timeout 5m;  </span><br><span class="line">        ssl_session_cache builtin:1000 shared:SSL:10m;  </span><br><span class="line">        resolver 8.8.4.4 8.8.8.8 valid&#x3D;300s;  </span><br><span class="line">        resolver_timeout 10s;  </span><br><span class="line">        add_header Strict-Transport-Security max-age&#x3D;63072000;  </span><br><span class="line">        add_header X-Content-Type-Options nosniff;  </span><br><span class="line">        server_tokens off;  </span><br><span class="line">        location ~\.htc($|&#x2F;)&#123;  </span><br><span class="line">          return 404;  </span><br><span class="line">        &#125;  </span><br><span class="line">        location ~ ^(.*)\&#x2F;\.svn\&#x2F;&#123;  </span><br><span class="line">          return 404;  </span><br><span class="line">        &#125;  </span><br><span class="line"></span><br><span class="line">    location &#x2F; &#123;  </span><br><span class="line">        proxy_pass http:&#x2F;&#x2F;elk.test.com:5601;  </span><br><span class="line">        proxy_http_version 1.1;  </span><br><span class="line">        proxy_set_header Upgrade $http_upgrade;  </span><br><span class="line">        proxy_set_header Connection &#39;upgrade&#39;;  </span><br><span class="line">        proxy_set_header Host $host;  </span><br><span class="line">        proxy_cache_bypass $http_upgrade;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>启动，开启防火墙端口，打开测试</p><p>三，<br />安装redis<br />wget <a href="http://download.redis.io/releases/redis-3.2.5.tar.gz" target="_blank" rel="noopener">http://download.redis.io/releases/redis-3.2.5.tar.gz</a><br />tar zxvf redis-3.2.5.tar.gz<br />cd redis-3.2.5<br />yum -y install tcl ruby tree gcc gcc-c++<br />make<br />make MALLOC=libc(如有这样的错误error: jemalloc/jemalloc.h: No such fileor directory执行）<br />make test</p><p>mkdir /data/redis/conf /data/redis/log /data/redis/data<br />make PREFIX=/data/redis/ install<br />通过vim命令修改<br />daemonize yes  介个是设置服务在后台运行</p><p>2、执行./utils/install_server.sh配置Redis配置之后Redis能随系统启动。</p><p>vi /etc/logstash/conf.d/logstash_nginx.conf</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">input &#123;  </span><br><span class="line">     file &#123;  </span><br><span class="line">        path &#x3D;&gt; [&quot;&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;logs&#x2F;access.log&quot;]  </span><br><span class="line">        type &#x3D;&gt; &quot;nginx_log&quot;  </span><br><span class="line">        start_position &#x3D;&gt; &quot;beginning&quot;  </span><br><span class="line">     &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">output &#123;  </span><br><span class="line">    redis &#123;  </span><br><span class="line">        host &#x3D;&gt; &quot;192.168.2.221&quot;  </span><br><span class="line">        key &#x3D;&gt; &#39;logstash-redis&#39;  </span><br><span class="line">        data_type &#x3D;&gt; &#39;channel&#39;     #此处的配置类型要与取redis的数据类型对应 ，一般为list  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在redis服务器上执行<br />redis-cli<br />127.0.0.1:6379&gt; SUBSCRIBE logstash-redis<br />查看是否收集到nginx日志<br />正常后修改data_type插入到redis中</p><p>四、安装配置logstash<br />vi /etc/logstash/logstash.yml</p><p>xpack.monitoring.enabled: true<br />xpack.monitoring.elasticsearch.url: [“<a href="http://192.168.147.82:9200" target="_blank" rel="noopener">http://192.168.147.82:9200</a>”]<br />xpack.monitoring.elasticsearch.username: “logstash”<br />xpack.monitoring.elasticsearch.password: “//jjdf”</p><p>cd /usr/share/logstash/<br />ln -s /etc/logstash ./config<br />./system-install /etc/logstash/startup.options sysv<br />echo ‘export “PATH=/usr/share/logstash/bin:$PATH”’ &gt; /etc/profile.d/logstash.sh<br />source /etc/profile.d/logstash.sh</p><p>logstash -e 'input { stdin { } } output { stdout {codec=&gt;rubydebug} }'测试</p><p>mkdir /etc/logstash/patterns</p><p>安装 x-pack插件（如不装插件无法进行连接）<br />/etc/logstash/conf.d/放导入配置文件</p><p>添加权限用户，kibana添加用户需要先添加role，网页里添加时不能添加.kibana索引的权限，在加任何一个通过kibana查看的用户都需要具体.kibana的权限才可以查看。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST -u elastic &#39;elk.test.com:9200&#x2F;_xpack&#x2F;security&#x2F;role&#x2F;kibana_guest&#39; -d &#39;&#123;  </span><br><span class="line">  &quot;indices&quot; : [  </span><br><span class="line">    &#123;  </span><br><span class="line">      &quot;names&quot; : [ &quot;.kibana*&quot; ],  </span><br><span class="line">      &quot;privileges&quot; : [ &quot;manage&quot;, &quot;read&quot;, &quot;index&quot; ]  </span><br><span class="line">    &#125;  </span><br><span class="line">  ]  </span><br><span class="line">&#125;&#39;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/pasted-3.png&quot; alt=&quot;upload successful&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/pasted-8.png&quot; alt=&quot;upload successful&quot; /&gt;&lt;br /&gt;
1.安装环境
      
    
    </summary>
    
    
      <category term="ELK" scheme="http://blog.99408.com/categories/ELK/"/>
    
    
      <category term="ELK" scheme="http://blog.99408.com/tags/ELK/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://blog.99408.com/2020/05/26/hello-world/"/>
    <id>http://blog.99408.com/2020/05/26/hello-world/</id>
    <published>2020-05-26T02:44:41.361Z</published>
    <updated>2020-05-26T02:44:41.361Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="quick-start"><a class="markdownIt-Anchor" href="#quick-start"></a> Quick Start</h2><h3 id="create-a-new-post"><a class="markdownIt-Anchor" href="#create-a-new-post"></a> Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="run-server"><a class="markdownIt-Anchor" href="#run-server"></a> Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="generate-static-files"><a class="markdownIt-Anchor" href="#generate-static-files"></a> Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="deploy-to-remote-sites"><a class="markdownIt-Anchor" href="#deploy-to-remote-sites"></a> Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
    
  </entry>
  
</feed>
